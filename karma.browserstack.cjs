require('dotenv').config();

module.exports = function (config) {
  config.set({
    basePath: '',
    frameworks: ['mocha'],
    plugins: ['karma-mocha', 'karma-mocha-reporter', 'karma-browserstack-launcher'],
    files: ['./node_modules/chai/chai.js', './tests/dist/index.js'],
    reporters: ['mocha', 'BrowserStack'],
    logLevel: config.LOG_INFO,
    colors: true,
    autoWatch: false,
    browserDisconnectTimeout: 10000,
    browserDisconnectTolerance: 2,
    singleRun: true,
    browserStack: {
      username: process.env.BROWSERSTACK_USERNAME,
      accessKey: process.env.BROWSERSTACK_ACCESS_KEY,
    },
    customLaunchers: {
      bsWinChrome: {
        base: 'BrowserStack',
        browser: 'chrome',
        browser_version: 'latest',
        os: 'Windows',
        os_version: '11',
      },
      bsWinEdge: {
        base: 'BrowserStack',
        browser: 'edge',
        browser_version: 'latest',
        os: 'Windows',
        os_version: '11',
      },
      bsWinFirefox: {
        base: 'BrowserStack',
        browser: 'firefox',
        browser_version: 'latest',
        os: 'Windows',
        os_version: '11',
      },
      bsMacChrome: {
        base: 'BrowserStack',
        browser: 'chrome',
        browser_version: 'latest',
        os: 'OS X',
        os_version: 'Sonoma',
      },
      bsMacEdge: {
        base: 'BrowserStack',
        browser: 'edge',
        browser_version: 'latest',
        os: 'OS X',
        os_version: 'Sonoma',
      },
      bsMacFirefox: {
        base: 'BrowserStack',
        browser: 'firefox',
        browser_version: 'latest',
        os: 'OS X',
        os_version: 'Sonoma',
      },
      bsMacVenturaSafari: {
        base: 'BrowserStack',
        browser: 'safari',
        browser_version: 'latest',
        os: 'OS X',
        os_version: 'Ventura',
      },
      bsMacSonomaSafari: {
        base: 'BrowserStack',
        browser: 'safari',
        browser_version: 'latest',
        os: 'OS X',
        os_version: 'Sonoma',
      },
      bsIos16Safari: {
        base: 'BrowserStack',
        device: 'iPhone 14',
        os: 'ios',
        os_version: '16',
        real_mobile: true,
      },
      bsIos17Safari: {
        base: 'BrowserStack',
        device: 'iPhone 15',
        os: 'ios',
        os_version: '17',
        real_mobile: true,
      },
      bsAndroid13Chrome: {
        base: 'BrowserStack',
        device: 'Samsung Galaxy S23',
        os: 'android',
        os_version: '13.0',
        browser: 'chrome',
        browser_version: 'latest',
        real_mobile: true,
      },
    },
    browsers: [
      'bsWinChrome',
      'bsWinEdge',
      'bsWinFirefox',
      'bsMacChrome',
      'bsMacEdge',
      'bsMacFirefox',
      'bsMacVenturaSafari',
      'bsMacSonomaSafari',
      'bsIos16Safari',
      'bsIos17Safari',
      'bsAndroid13Chrome',
    ],
  });
};
